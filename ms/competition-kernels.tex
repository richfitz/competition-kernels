\documentclass[a4paper,11pt]{article}
\usepackage[osf]{mathpazo}
\usepackage{ms}
\usepackage{natbib}
\usepackage{graphicx}
\usepackage{caption}

% Allow referencing into the supporting information, once that exists.
\IfFileExists{./competition-kernels-supporting.tex}{%
  \usepackage{xr}%
  \externaldocument{competition-kernels-supporting}}{}

\title{Something about competition kernels}
\author{}
\date{}
\affiliation{}
\runninghead{}
\keywords{}

\newcommand{\ud}{\ensuremath{\mathrm{d}}}
\newcommand{\sign}{\mathop{\mathrm{sign}}\nolimits}
\newcommand{\Rstar}{\ensuremath{R^*}}

\begin{document}

% Disable words breaking over lines for final submission:
% \raggedright
% \pagestyle{empty}

% \mstitlepage
\parindent=1.5em
\addtolength{\parskip}{.3em}

% \begin{abstract}
% \end{abstract}

\section{Introduction}

% Competition kernels are widely used in both models and arguments
%
% * A fundamental measure of community dynamics: kernels represent the
%   fitness landscape drawdown
% * Example usage
%   - limiting similarity \citet{MacArthur-1967}
%   - coexistence
%   - character displacement \citep[e.g.,][]{Taper-1985, Case-2000,
%     Goldberg-2006}
%   - game theory \citep[e.g.,][]{Brown-1987, Brown-1987-140}
%   - disruptive selection and adaptive dynamics \citep{Dieckmann-1999}
% * Species packing remains a hugely influential concept: the
%   niche is usually reprensented as a Gaussian disstribution in one
%   dimension (e.g., Ricklefs' textbooks over the years: p 602 in
%   1999, v4).
%
% Keep this section nice and general: avoid specific mentions of LV,
% etc but bring in the key points.
Arranging species along a trait or resource axis and supposing that
species ``repel'' each other is deeply ingrained in ecological thought
(Figure \ref{fig:competition-kernels}).
%
The widths of species preferences along an axis somehow represents
their realised niche \citep[\textit{sensu}][]{Hutchinson-1957}, and
the force that keeps species separated is competition.
% Argh, where is the link?
Imagining species as having roughly Gaussian niches in one dimension\ldots
% Meh, this bit is shit:
These ingredients are foundational in models of limiting similarity
\citep{MacArthur-1967}, character displacement \citep{Taper-1985,
  Case-2000, Goldberg-2006}, sympatric speciation
\citep{Dieckmann-1999} and coexistence.

% Competition kernels, and models of competition, are largely
%   unchanged from their original formulation in the 1960s.
%
% * Based on Lotka-Volterra equations (\citealt{MacArthur-1967}
%   references Volterra 1926), with a function for competition in terms
%   of a pair of species traits; the main fomulation due to
%   \citet{MacArthur-1967}
% * These models have been criticised from the outset:
%   - Andrewartha-1953:
%   - May-1972
%   - Neill-1974: competition functions not meaningful
%     properties of species pairs, are density and context dependent.
%   - Abrams-1975: sensitive to details about how resources
%     are used
%   - Abrams-1980: implicit assumptions likely to be violated leading
%     to density dependent competition
% * Surprisingly, most of the criticism of shape focusses on the
%   ease with which \emph{continuous coexistence} is possible, rather
%   than focussing on what shapes are meaningful: we have very little
%   information on the likely shapes in nature aside from the assertion
%   that a Gaussian is a likely reasonable low-order approximation.
Despite their centrality in modelling and ecological thought, models
of competition remain largely unchanged from their original
formulation in the 1960's, with the most popular version due to
\citet{MacArthur-1967}.
% Probably point at the methods here.
Generally species are assumed to inteact following the Lotka-Volterra
equations (REFS), with the intensity of competition between two
species ($\alpha_{ij}$) being some function of the two species traits
(for a trait axis $x$, $\alpha_{ij} = \alpha(x_i, x_j)$; see Methods).
%
This formulation implies among other things that competition is linear
in intensity with species abundances, is additive across multiple
competing species, and that the \emph{shape} of competition is an
intrinsic (i.e., not context-dependent) property of pairs of species.
%
While possibly justifiable as low-order approximations, these
assumptions have been widely criticised as long as the models have
been used
\citep[e.g.][]{Andrewartha-1953,May-1972,Abrams-1975}.

% TODO: I'd love something here where we can report on any attempts to
% measure the *shape* (not intensity) of competition in nature.
%
% NOTE: I'm very loose with using trait and resource here, and
% probably we need to make that connection so that we can use traits
% below -- I've added the shift here so we probably just want to
% strictly talk about resources above?
The shape of the competition kernel with respect to resources and
species traits has recieved less attention \citep[but
see][]{Abrams-2008,Leimar-2013}; typically a Gaussian or a form of
$\alpha(x_i, x_j) \propto \exp((x_i - x_j)^4)$ is used, or more rarely
an asymmetric logistic.
%
While originally concieved as functions with respect to a resource,
and connnecting through traits via some ``utilisation function''
\citep{MacArthur-1967}, competition functions have increasingly
shifted to be expressed with respect to traits.
%
This shift seems to start with work on character displacement
\citep{Taper-1985} and has continued as the focus moves from
competition as a mechanism for structuring communities and to
affecting evolution of species traits.
%
Surprisingly, most of the focus on shape has focussed on the
possibility of ``continuous coexistence'' or ``limiting similarity'',
and less on what shapes are likely or meaningful.
% OK, this dribbles off.  Could delete this sentence or replace with
% something stronger?
For many models (e.g., character displacement) the detailed form of
competition is not the focus of study, but some form of competition
must be assumed to make the models run.
% NOTE: Perhaps worth a mention of the difficulty of measuring the
% shape (not intensity) of competition in nature here?
%
% NOTE: Fundamentally the issue here is that modellers are studying
% the behaviour of the models, but that's become a cottage industry
% itself.

% NOTE: Might be worth motivating that this work is useful because it
% provides more promising avenues for actually linking models to the
% field.

% I wonder if this goes above?
\textit{If we understood competition kernels with respect to traits,
  we could}
\begin{itemize}
\item Measure real competition kernels in nature
\item Predict trait-mixtures better than species mixtures.  Is there a
  signature of competition in extant trait-mixtures?  What would it
  be?
\item Measuring competition along trait gradients in the field likely
  intractable, but possible in models where competition emerges from
  first principle ingredients about biological processes that we think
  are important.
\item Basing an entire field on competition kernels where we don't
  even know their shape seems like a house of cards.
\end{itemize}

% At the same time, other strands of modelling aimed to link species
%   traits, competition and coexistence via more explicit representation
%   of resoucres.
%
% * Soil resources, via R* \citep{Tilman-1980,Tilman-1982}. this line of theory
%   aimed to link  resource dynamics to competition via species
%   competing for different pools of  resources.  It contains many of
%   the same ingredients as the  \citet{MacArthur-1967} model, but
%   with slower replenishment of resources.
% * Space, via Sessile dynamics, lottery models, competition-colonisation
%   models, through to neutral theory. All assumed total number of fixed sites,
%   with individuals competing for these.
% * Light, via models of successional turnover \citep{Huston-1987,
%   Kohyama-1993}.
%   Focus on size-structure and assymetric nature of competition.
% * Important point in all of these is that compeitive affect of one species
%   on another operates via competition for resource. This makes the shape of
%   competiton coefficents are an emergent  property of system.
Parallel sets of research have linked species traits, competition and
coexistence via more explicit representation of resources.
%
The ``\Rstar'' model of \citet{Tilman-1982} includes many of the same
ingredients (resources, population growth) framed in a similar way to
the \citet{MacArthur-1967} model, but with slow replenishment of
resources.
% OK, this is one I can't really write well.  It just seems too
% literature review-y.  Also note that the C/C models might also be LV
% models -- that point might want highlighting in the discussion.
\ldots
%
Important point in all of these is that compeitive affect of one
species on another operates via competition for resource, like
\citet{MacArthur-1967}, but while explicitly considering the resources
dynamics.  This makes the effect of competition, including its shape
with respect to species traits, an emergent property of a system.

% **Aim of this paper** to investigate the shape and behaviour of
% competition kernels in mechanstic models of growth and reproduction.
%
% In a sense our approach is similar to \citet{Draghi-2012}; we're
% going to look at models that are simple enough to push around but
% complicated enough that we don't immediately know the emergent
% behaviours and use this as a proxy to do things we can't easily do
% in natural systems.
%
% This makes it sound a lot grander than what we're actually going to
% do.  I know people always overestimate how much is required in a
% paper, but are we actually going to *do* enough?
Here, we investigate the shape and behaviour of competition kernels in
mechanistic models of growth and reproduction.

Key questions asked of each model:

\begin{itemize}
\item What is the shape of the competition function emerging from the
  model? Is it Gaussian? Is it symmetric?
\item Does the shape of the competition function vary with traits of
  the resident species?
\item Does the shape of the competition function vary with traits of
  density of the resident species?
end{itemize}

\section{Models}

% In the first paragraph, I guess we describe the entire approach as
% well as possible.

We investigated the dynamics of two quite different models -- TREE and R-star
-- where the competitive impact of one species on another arises via the
effect of individuals on a shared resource. In each model, species traits
influence the dynamics of resource use and thus competitive interactions. For
each model, we compute the core quantities used in the Lotka-Volterra
equations (growth rate, carrying capacity,  per-capita rate of population
increase) and from that infer the shapes of competition functions.

The standard Lotka-Volterra equations express the per capita rate of increase
in the abundance $N_i$ of species $i$ as a product of two terms. The first
gives the maximum possible per-capita growth rate $r_i$. The second expresses
the degree to which that maximum is realised, and thus includes any reductions
due to competition. A commonly used form for Lotka-Volterra dynamics is

\begin{equation}
\label{eq:LV}
\frac{\ud N_i}{\ud t} \frac{1}{N_i} =  r_i \left(1 - \sum_j
                                      \frac{\alpha(i,j) N_j}{K_i}\right),
\end{equation}

where $K_i$ is the equilibrium value for $N_i$ when species-$i$ is grown in a
monoculture  (i.e. carrying capacity), and $\alpha(i,j)$ is the per-capita
competitive effect of species-$j$ on species-$i$. (There are other forms for eq
\ref{eq:LV} that we do not consider further here. While these differ subtly in
the nature of density dependence, alternative forms retain the same overall
structure of a maximum possible rate multiplied by some reduction due to
competition). By convention, competition functions are expressed as the effect
of species-$j$ on species-$i$, relative to the effect of species-$i$ on itself.
Thus $\alpha(i, i) \equiv 1$.

We are interested in situations where the different parameters in eq.
\ref{eq:LV} are functions  of traits. Moreover, we restrict our
attention to situations where a single type with traits
$x_I$ is trying to invade a community of single resident type with traits
$x_R$. The reason for this narrowing of focus is that it is not possible to
infer the shapes of competition coefficients in situations with more than one
resident, because the number of unknowns increases faster than the number of
species (refs?).  The fitness $f(x_I, x_R)$ of the invading type is
then
\begin{equation}
  \label{eq:LVi}
   f(x_I, x_R) = \frac{\ud N(x_I)}{\ud t} \frac{1}{N(x_I)} =
    r(x_I)\left(1 - \alpha(x_I, x_R) \frac{K(x_R)}{K(x_I)}\right).
\end{equation}

To estimate the shapes of competition coefficients embedded within the R-star
and TREE models, we use those models to calculate all the trait-dependent
terms in eq. \ref{eq:LVi} except $\alpha(x_I, x_R)$:
\begin{enumerate}
  \item $f(x_I, x_R)$: fitness of rare invader with traits $x_I$  in competition
  with a established resident with traits $x_R$
  \item $r(x_I)$: maximum possible fitness of invader, i.e. in absence of competition,
  \item $K(x_I)$: equilibrium population density of invader when growing in monoculture.
  \item $K(x_R)$: equilibrium population density of resident when growing in
  monoculture.
\end{enumerate}
We then solved for $\alpha(x_I, x_R)$ by rearranging  \ref{eq:LVi} to give:
\begin{equation}
  \label{eq:alpha}
 \alpha(x_I, x_R) = \frac{K(x_I)}{K(x_R)}
  \left(1 - \frac{f(x_I, x_R)}{r(x_I)}\right).
\end{equation}

\subsection{R-star model}

In the first model (R-star) individuals compete for two essential and
depletable resources. This model is one of the best studied and cited models
of resource competition \citep{Tilman-1977, Tilman-1982, Huisman-1999},
originating from a study on exploitative competition for any generic resource
\citet{Leon-1975}. We implemented a version where the specific growth rates
follow a Monod equation \citet{Huisman-1999}, but which is otherwise similar
to the widely-cited implementation by Tilman \citep{Tilman-1977, Tilman-1982}.

In the R-star model, per capita growth rates for each species depend on the
availabilities of two resources. We assume both resources are necessary (i.e.
non-substitutable), so the growth rate of each species is determined by the
resource which is currently most limiting. The resource availabilities, in
turn, depend on  the rates of resource supply and consumption. Individuals
compete with one another by drawing down the joint resource pools. Such a
system is easily described via a minimal set of equations (Appendix
\ref{App:Rstar}).

Following previous authors \citep{Tilman-1985, Schreiber-2003, Fox-2008} our
analyses focus on a trait determining the relative amounts of each resource
required for growth, i.e. the stoichiometry of resource needs. Species can
vary from requiring mostly resource 1, to equals amounts of both resources, to
mostly resource 2. This dependence is achieved by making uptake saturation
constants for resource 1 inversely related to the requirement of resource 2:
\begin{equation}
\label{eq:R3}
U_{1i} = 1-U_{2i}.
\end{equation}

\subsection{TREE model}

In the second model (TREE) individual plants compete for light within a patch
and size-structured metapopulation \citet{Falster-2011, Falster-2015}.
Vegetation in this model comprises a large number of patches subject to a
prevailing disturbance. Disturbances remove established vegetation within a
patch, which is then recolonised via seed dispersal from other patches.
Individual plants progress through their life-cycle, from seeds until mature
adults, with growth survival and fecundity rates determined by the combined
effect of an individual's traits, its current size and the degree of shading
from other plants within the same patch. The amount of shading at a given
height is computed from the cumulative leaf area above that height; short-term
competitive effects are therefore size-asymmetric. The sole effect of shading
is to alter an individual's photosynthetic income. Following
\citep{Falster-2015}, the fitness of individuals with a given type is
calculated by integrating seed output across the entire metapopulation.

We use the TREE model to estimate trait-based competitive coefficients for
two traits whose evolutionary dynamics have recently been investigated
\citet{Falster-2015}: leaf mass per area (LMA) and height at maturation
(HMAT). In the model, LMA moderates a physiological trade-off between the cost
of building an extra unit of leaf area and the rate of leaf turnover.
Variation in LMA thereby underpins a trade-off between height growth rate and
shade-tolerance of seedlings. Meanwhile, HMAT moderates the allocation of
surplus energy between growth and seed production, as an individual increases in
size.

\clearpage

\section{Results}

\subsection{Figures}

\begin{enumerate}
\item Classic niche packing
  \begin{itemize}
  \item Possibly from old and new textbooks
  \item Point is that these ideas are deeply ingrained in biologists,
    and that all readers will have seen this before.
  \item Krebs figure that has remained unchanged since 1973 could be a
    nice one; we can make the point that it is unchanged rather than
    drawing it twice.
  \end{itemize}
\item Ingredients in models of competition (multipanel figure)
  \begin{itemize}
  \item First two panels are $r$ and $K$, which are constant for a
    given set of parameters, and hold for all resident communities
    (but would vary with traits/parameters).
  \item Next panel is fitness, with some indication of who can
    invade.  We have some disagreement about the importance of this
    function, so might not be too prominent in final version.
  \item Bottom panel is inferred competition.  Because we'll be
    dealing with \citet{Dieckmann-1999} or something, all the
    competition metrics should line up.  Do the bottom two panels for
    two different resident communities showing that the competition
    kernels simply move around but stay the same shape.  We can only
    handle a single resident for some of the competition measures.
  \end{itemize}
\item R-star competition estimation
  \begin{itemize}
  \item general shape
  \item Change in shape with parameters and/or resident position --
    residents probably more important though as parameters should
    change kernels extensively in most modls.
  \item Not many panels for each figure to keep it simple.  But make
    figures like 2 for the SM that show the different ingredients that
    are going into the calculation.
  \item Show the different measures of compettion provided that they
    all fit on the page nicely; \citet{Abrams-2008} makes the point
    that if different measures don't line up then competition is
    density dependent.
  \end{itemize}
\item Hmat competition estimation
  \begin{itemize}
  \item Choose a case where we don't have coexistence to keep it
    separate.
  \item First because it most closely matches \citet{Kisdi-1999} and
    because the results are really simple and don't look too weird.
  \end{itemize}
\item LMA competition estimation
  \begin{itemize}
  \item For LMA we want to get the curve into a bifurcation like point
    where coexistence is possible on both sides
  \item Show that the points that coexistence is possible on the RHS
    are the dips in the competition function to make the case that
    this is a fundamentally different way that competition might allow
    coexistence in models with nonlinear density dependent
    competition.
  \end{itemize}
\item Density dependence in competition models
  \begin{itemize}
  \item Something showing that the competition kernels are density
    depdenent.  Because this is a three dimensional functions (trait,
    competition strength and resident density) we can only show slices
    through two of these.  At different densities show how the
    kernels look with respect to traits.  Possibly do that at two
    different resident communities.
  \item Need to pick a model to do this with - could be any of the
    three and for completeness we might want to add them to the SM.
  \end{itemize}
\end{enumerate}

\clearpage
\section{Discussion}

\textit{Main issues of competition models illustrated by our analysis}
\begin{itemize}
\item No clear generalisation yet about competition kernel shapes.
  \begin{itemize}
  \item our lma kernel looks a little like the
    \citet{Roughgarden-1979} offset Gaussian, but the ridges are
    likely important for later species (we need to actually show this
    however)
  \item our hmat kernel looks like the \citet{Kisdi-1999} asymmetric
    kernel, and the dynamics are fairly similar (needs
    demonstrating).
  \item The R* kernels just look weird, but that's because the
    \emph{trait} doesn't really map onto the resource very directly;
    the trait is the preference for two different resources, which
    can't map onto any single resource very well.
  \end{itemize}
\item Kernels other than Gaussian may lead to coexistance more easily
  than Gaussian.
  \begin{itemize}
  \item It's not all bad news; kernels like the lma kernel look
    ridiculous and you're not going to be allowed to propose them for
    a modelling paper.
  \item But they arise from size-structured dynamics in the model, so
    may not be that uncommon (worth noting that almost all the models
    are really of discrete exchangeable adults and that size/age
    structure was flagged as an issue arges ago but I've lost the
    paper).
  \end{itemize}
\item Density dependent competition emerged in every model, as
  predicted by \citet{Abrams-1980}, who argued that not satisfying
  implicit assumptions would lead to widespread nonconstant density
  dependence.
\item More than density dependence, the \emph{shape} of the kernel
  changes with density, moving in position as the resident population
  density changes.  Kernels of this type simply haven't been studied
  and it's not actually very clear if kernels of this type might
  stretch the concept beyond its useful limit.
\item Outcome of competition is governed by the relative shapes of r,
  K and $\alpha$ but most modelling focusses only on the competition
  kernel, setting $K$ to be uniform or Gaussian and setting $r$ to be
  uniform.  The exception is asymmetric competition studies that tend
  to use asymmetric $r$ functions (pointing in the opposite direction
  of competitive ability). We don't know what \emph{any} of these look
  like in nature.
\end{itemize}

\textit{Traits are a productive way forward -- for what?}
\begin{itemize}
\item What did we want to say here, really?  Traits are already how
  people are thinking about kernels, but the work on resources hasn't
  caught up (see last point)
\item In a way, we're arguing to turn the way that we've looked at
  competition around: rather than asking ``given we know species
  coexist, what do we have to do to competition kernels'', we're
  saying: ``given we have data on species traits, can we just look at
  the shapes that competition functions actually take and use that to
  guide future modelling''.
\end{itemize}

\textit{(Maybe) link to field measurement of competition.}
\begin{itemize}
\item Most manipulative measures of competition in the field are going
  to give \emph{discrete} estimates of $\alpha$: the amount of
  competition exerted by or felt by a single species in the context of
  some community.
\item Because original, \citet{MacArthur-1967}, version of competition
  kernels was designed around resource utilisation functions, it
  should be possible to estimate competition coefficients and kernels
  from shapes of those functions if they were estimatable.
\item Does our way offer any better way forward?  The nonmanipulative
  work that Georges is doing with the working group data, or that
  James is looking at with the BCI data might help; we have large data
  sets of traits and growth; the signature of competition may show up
  there (perhaps we could put it on a manifold\ldots).
\end{itemize}

\textit{Trait-resource utility linkage is important, but largely
  ignored.  Mechanistic models provide some sort of way forward.}
\begin{itemize}
\item Of course we don't actually make this link in the model --
  perhaps we should
\item The 1:1 mapping happened very quietly, but the resource axis has
  gradually been entirely replaced by trait axes.  We argue that
  neither are likely to exhibit behaviour like the
  \citet{MacArthur-1967} model in natural systems.
\item There is a shift in the 1980s from modelling limiting
  similarity in terms of resources to modelling trait
  divergence/convergence and disruptive selection.
  \begin{itemize}
  \item Begins with \citet{Taper-1985} and \citet{Brown-1987-140}; these
    make explicit a direct 1:1 trait:resource mapping implied by the
    previous models.
  \item Continued as the models were used in adaptive dynamics
    \citep[e.g.,][]{Dieckmann-1999} and then picked up by physicists
    \citep[e.g.,][]{Leimar-2013}
  \item For vertebrate animals, this connection has always been fairly
    defendable for the sorts of traits people think about (e.g., finch
    beak size --- Lack), but for plants the resource axis is hard: most
    plants would rather more light.  Shifting to traits with some
    complicated nonlinear map between traits and resources offers a way
    forward, though it makes the links to resources and underlying
    process muddier.
  \end{itemize}
\item It's hard to bridge between abstract models of competition that
  inform most theory with the sort of traits and species data that we
  have for plant communities.
\end{itemize}

\textit{Conclusions}
\begin{itemize}
\item Coming up with a positive note here might be hard.
\end{itemize}

\section{Figures}

% * Classic niche packing
%   - Possibly from old and new textbooks
%   - Point is that these ideas are deeply ingrained in biologists,
%     and that all readers will have seen this before.
%   - Krebs figure that has remained unchanged since 1973 could be a
%     nice one; we can make the point that it is unchanged rather than
%     drawing it twice.
\begin{figure}[h]
  \centering
  % \includegraphics{figs/competition-kernels}
  \caption{Competition kernels}
  \label{fig:competition-kernels}
\end{figure}

\clearpage
\bibliographystyle{amnat}
\bibliography{references}


\section{Appendices}

\subsection{Details about Lotka-Volterra equations}\label{App:LV}

\subsection{Details about R-star model}\label{App:Rstar}

We consider an unstructured system where individuals compete for two
resources. Let $N_i$ be the abundance of species-$i$ and $R_1, R_2$ be the
abundances of the two resources. The population of species-$i$ increases at
growth rate $\mu_i(R_1,R_2)$, a function of the resource availabilities, and
decreases with mortality rate $m$. Species-$i$ thus depletes each resource at
rate $c_{ji} \,  N_i \, \mu_i(R_1,R_2)$, where $j = 1, 2$. Resources are replenished
with supply rate $S_j$ and turnover at rate $D_j$. under these assumptions, the dynamics of species and resource abundance are given by
\begin{subequations}
  \begin{align}
\label{eq:R1}
\frac{dN_i}{dt} &= N_i \, \mu_i(R_1,R_2) - N_i \, m \\
\frac{dR_j}{dt} &= D \, (S_j- R_j) - \sum_{i=1}^{n}{c_{ji} \, N_i \,
  \mu_i(R_1, R_2)}.
\end{align}
\end{subequations}

The specific growth rates for each species are assumed to follow a Monod equation,
and be determined by the resource which is most limiting:
\begin{equation}
\label{eq:R2}
\mu_i(R_1, R_2) = r_i \, \min \left(\frac{R_1}{U_{1i} + R_1},
                                    \frac{R_2}{U_{2i} + R_2} \right).
\end{equation}
% NOTE: In above equation `U` was previously labelled `K`. I suggest we use U
% over K because K is already used in the Lotka Volterra equations, so reusing
% same symbol here is likely to cause confusion.

In eq. \ref{eq:R2} $r_i$ is the maximal growth rate rate of species i, $U_
{ji}$ is the half saturation constant for species $i$ limited by resource $j$.

\subsection{Details about TREE model}\label{App:TREE}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% TeX-PDF-mode: t
%%% End:

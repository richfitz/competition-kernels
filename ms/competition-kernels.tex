\documentclass[a4paper,11pt]{article}
\usepackage[osf]{mathpazo}
\usepackage{ms/ms}
\usepackage{natbib}
\usepackage{graphicx}
\usepackage{caption}
\usepackage[labelfont=bf]{caption} % make label for figure bold
\usepackage{tabularx}
\usepackage{adjustbox}
\usepackage{color}

\doublespacing

% How to use comments:
% - if you want comments and colors to show, make sure that the lines under "COMMENTS & REVISIONS -- ON" DO NOT have a '%' in front of them, but the ones after "COMMENTS & REVISIONS -- OFF "
% - to remove colors and comments, switch the '%% to the first block (and make sure the second block does not have it).

%%% COMMENTS & REVISIONS -- ON %%%%
\newcommand{\rev}[1]{{\color{navy}{#1}}}
\newcommand{\verify}[1]{{\color{navy}{(verify: #1)}}}
\newcommand{\todo}[1]{{\color{navy}{(todo: #1)}}}


%%% COMMENTS & REVISIONS -- OFF %%%
% \newcommand{\rev}[1]{{#1}}
% \newcommand{\verify}[1]{{#1}}
% \newcommand{\todo}[1]{}

% Instructions for Am Nat: https://www.journals.uchicago.edu/journals/an/instruct?mobileUi=0&


%---------------------------------------

\title{ARTICLE: The emergent shape trait-based competition functions in resource-based models for competition among plants: Gaussians are not normal}

\author{Daniel S. Falster\textsuperscript{1,*}, Georges Kunstler\textsuperscript{2}, Richard G. FitzJohn\textsuperscript{3}, Mark Westoby\textsuperscript{4}}

\affiliation{
	\textsuperscript{1} Evolution \& Ecology Research Centre, and School of Biological, Earth and Environmental Sciences, University of New South Wales, Sydney NSW 2052, Australia\\
	\textsuperscript{2} Univ. Grenoble Alpes, INRAE, LESSEM, 2 rue de la Papeterie-BP 76, St-Martin-d’Héres, F-38402 France\\
	\textsuperscript{3} Department of Infectious Disease Epidemiology, Imperial College London, Faculty of Medicine, Norfolk Place, London W2 1PG, United Kingdom\\
	\textsuperscript{4} Department of Biological Sciences, Macquarie University,  Sydney, Australia;
	\textsuperscript{*} Author for correspondence: daniel.falster@unsw.edu.au
	}

\runninghead{Competition functions in resource models}
\keywords{Competition, resource, coexistence,}

\newcommand{\ud}{\ensuremath{\mathrm{d}}}
\newcommand{\sign}{\mathop{\mathrm{sign}}\nolimits}
\newcommand{\Rstar}{\ensuremath{R^*}}
\newcommand{\plant}{{\tt plant}}
\newcommand{\hmat}{\ensuremath{h_{\text{mat}}}}
\newcommand{\lma}{\textsc{lma}}

\begin{document}

% Disable words breaking over lines for final submission:
% \raggedright
% \pagestyle{empty}

\mstitlepage
\parindent=1.5em
\addtolength{\parskip}{.3em}

% \doublespacing

\newpage 

\begin{abstract}

In community ecology, two different approaches have been used to model the impacts of competing populations (often species) on each other, via their traits. In trait-based Lotka-Volterra (LV-T) models, each individual's per capita impact on others is pre-specified via a competition function, calculated from trait differences. By contrast, in resource-based (RB) models, this per capita impact emerges dynamically through depletion of a shared resource, such as light or nutrients. To bridge between these two lines of theory, we investigated how well the common shapes used for competition functions in LV-T models approximated the shapes that emerged from interactions within the RB models. For two different RB models, we estimated the shape of the competition function implied by the model, when individuals were competing for either light or nutrients. In only one of the scenarios investigated did the trait-based competition function in the RB model resemble any of the shapes used in LV-T models. The mismatch between these two approaches suggests that theory derived using fixed competition functions and LV-T models may not apply well to systems where individuals compete for shared resources.

\end{abstract}

\section{Introduction}

Competition is a powerful force structuring ecological communities \citep{Schluter-2000, Vellend-2016, Edwards-2018}. In the short term, competition for scarce resources regulates the overall abundance of individuals in a community. Over longer time frames, competition among different strategies reshapes community structure and dynamics, by favouring some strategies over others. Such selective effects can drive evolutionary arms races, which favour traits giving prior access to a resource, while also regulating the diversity of strategies--and thereby species--that can coexist \citep[e.g.][]{Gause-1934, Lack-1947, MacArthur-1967, Chesson-2000}. Understanding how traits influence the strength and dynamics of competitive interaction among individuals is thus a foundation for theories of community assembly and adaptive evolution.

A common approach for embedding competitive processes within models of community assembly is via the phenomenological Lotka-Volterra model, wherein the population dynamics of different competing populations are determined by their intrinsic rates of population increase, carrying capacity, the density of competitors, and so-called ``competition coefficients'' \citep{Lotka-1932, Volterra-1926, Andrewartha-1953} --- constants describing how the per capita rate of population growth for one strategy is reduced by the abundance of another strategy. The Lotka-Volterra model captures saturating population growth behaviour, an essential feature assumed present in nearly all biological populations; i.e. the tendency for per capita growth to start high and then progressively slow, as competition intensifies, towards its carrying capacity. Variants of the Lotka-Volterra model form the foundation for much theory in community ecology and evolution, including the competitive exclusion principle \citep{Gause-1934}, limiting similarity \citep{MacArthur-1967, May-1972, Slatkin-1980, Abrams-1983}, character displacement \citep{Taper-1985, Case-2000}, species coexistence and community assembly \citep{MacArthur-1967, Calcagno-2006, Leimar-2013, DAndrea-2019}, Chesson's coexistence theory \citep{Chesson-2000,Barabas-2018}, and sympatric speciation \citep{Dieckmann-1999}.

A key feature in several theory strands derived from Lotka-Volterra models is linking competitive outcomes and traits. This link is achieved via a ``competition function'', which relates the size of the constant competition coefficient to the absolute difference in some trait between the two competing populations. Historically, researchers mainly used Gaussian shapes for this function, which suggest strategies with similar traits compete intensely for resources, and that competitive coefficients decline with the absolute differences in trait values via a Gaussian curve (Table \ref{tab:shapes}). We refer to such models as LV-T (trait-based Lotka-Volterra) models below \citep{Klausmeier-2020}. Indeed, the idea of species arranged along a resource axis, differentiated in their resource use via some trait and with Gaussian decline in either resource utilisation of competitive impact (e.g., Fig. \ref{fig:competition-functions}), is iconic within community ecology and is almost universally present in textbooks from 1970s through to the present \citep[e.g.,][]{Krebs-1972, Ricklefs-1973, Ricklefs-1999, Krebs-2013}. While originally derived with reference to resource utilisation curves \citep{MacArthur-1967, Roughgarden-1979}, in most formulations resources are not modelled explicitly, rather implied via the competition coefficients.

While Gaussian competition functions have been the most-common shape, alternative shapes have also been considered (Table \ref{tab:shapes}). An asymmetric function has been used where size gives exclusive access to a resource \citep[e.g.][]{Law-1997, Kisdi-1999, Geritz-1999, Egas-2004, Calcagno-2006, DAndrea-2013} (Table \ref{tab:shapes}). More recently, researchers have considered so-called ``kinked'' functions (Table \ref{tab:shapes}), with shapes that are not continuously differentiable \citep{Calcagno-2006, Scheffer-2006, Pigolotti-2007, Leimar-2013, Barabas-2013}. These studies have clarified an important point: the shape of the competition function can fundamentally alter the diversity of strategies supported in modelled communities. Specifically, the question of whether the community at equilibrium will be constituted of evenly spaced distribution of traits (limiting similarity), or continuous coexistence of traits (no limiting similarity) will be dependent of slight variation in the shape of the competition function

These studies have clarified an important point: the shape of the competition function can fundamentally alter the diversity of strategies supported in modelled communities. Specifically, the question of whether the equilibrium community consists of an evenly spaced distribution of traits (limiting similarity) or continuous coexistence of traits (no limiting similarity) can depend critically on slight variations in the shape of the competition function \citep{Scheffer-2006, Pigolotti-2007, Leimar-2013, Barabas-2013, DAndrea-2013}. Generally, kinked functions (Table \ref{tab:shapes}) are more likely to lead to continuous coexistence, as they lead to a steep increase in fitness close to the existing resident. However, continuous coexistence may also occur with the classical Gaussian function, depending on how traits affect carrying capacity \citep{Leimar-2013}. These results reinforce similar insights suggested in earlier review of limiting similarity theory \citep{Abrams-1983}: that precise details of the competitive process can fundamentally alter the mixtures of traits favoured in an ecosystem.

An alternative approach for linking competition with community assembly and traits is to explicitly model the abundance of shared resources and their depletion by populations of different individuals on the basis of their traits (hereafter called `Resource Based` RB models'). Unlike the LV-T models, the competitive effects of populations on each other in RB models are not specified directly, but rather emerge via the aggregate effect on shared resources. Resources commonly considered for plant communities include light, nutrients, and water. The most prominent model of this type is Tilman's consumer-resource (or ``\Rstar'') model \citep{Tilman-1977, Tilman-1982}, which focuses on the minimal resource level individuals can tolerate. A second class are successional models for forest communities, where there is size-structured competition for light \citep{Huston-1987,Kohyama-1993,Moorcroft-2001,Falster-2011,Falster-2016,Weng-2019}, and potentially also competition for nutrients or water \citep{Moorcroft-2001,Farrior-2013, Smith-2014, Fisher-2018,Weng-2019}. While the consumer-resource model has commonly been used to investigate questions about community assembly, size-based successional models have historically been used to answer questions about carbon, water and nutrient cycles more than community assembly \citep{Moorcroft-2001,Medvigy-2012,Smith-2014,Fisher-2018} with few formal analyses of community assembly \citep{Kohyama-1993}.

One reason size-based models have not been used to investigate questions about community assembly is because demographic quantities like the per capita growth rate of individuals in each population, central to most success of theory using LV-T models, are difficult to calculate for size based models. Recent advances in the numerical solving of size-structured models \citep{Falster-2016}, however, have allowed per capita growth rates to be estimated for entire metapopulations, thereby enabling direct modelling of trait-based community assembly in complex size- and patch-structured communities \citep{Falster-2017}. A downside of using RB models for questions about community assembly, especially the size-based models, is that they can be more computationally demanding to run and therefore investigate, making LV-T models of continuing interest.

Despite addressing similar questions -- about the the diversity and structure of ecological communities, especially in relation to traits -- studies using LV-T models and resource-based models have remained largely isolated from one another. In this paper we try to bridge this divide, by asking how well the signature of competitive interactions that emerges from RB models resembles the trait-dependent competition functions assumed within LV-T models. LV-T models make strong assumptions about the dynamics of competitive interactions. LV-T models assume that all competitive interactions within the community can be summarised via a matrix of pairwise and constant competition coefficients, that the total competitive effect of a series of competitors can be inferred by summing their pairwise impacts, and that per capita strength of impact is density independent. Additionally, models using trait-based competition functions assume that competitive interactions between two populations can be represented via a competition function with a definite shape (such as in Table \ref{tab:shapes}), and that the shape of the competition function is invariant with the absolute value of the trait. If these assumptions are supported by more mechanistic RB models inspired by natural systems, where competitive effects emerge from lower-level interactions, then 1) LV-T models can be used as an effective macroscopic summary for more complex models, and 2) our confidence would increase that insights derived from LV-T models apply broadly within natural systems.

To that end, we determine the shape of the emergent competition functions that are produced in the RB models, where the abundance and depletion of resources is represented explicitly, and used these to verify several assumptions implied by the structure of the competition functions within LV-T models. We consider two classes of RB models: Tilman's consumer-resource (or model involving competition for essentials nutrients depending on the populations resource use and requirement, and a size-based successional model (\plant\ ) involving competition for light in disturbance-prone vegetation, and influenced by physiological traits. Our hope was that these shapes would resemble one of the shapes used in previous LV-T models (Table \ref{tab:shapes}), as this would assure us that insights gained from LV-T models perhaps generalise to resource-based models. In a previous study, \citet{Abrams-2008} found the consumer-resource model to satisfy few of the assumptions that underpin LV-T models. Our analysis extends \citeauthor{Abrams-2008} approach by considering not just competition coefficients, but trait-based competition functions, and including an additional class of resource-based model, involving size-based competition for light.

\section{Methods}

We investigated the dynamics of two RB models: a Consumer-resource model and a size-based successional models, in which the competitive impact of one type on another emerges from the joint impact of all individuals in depleting a shared resource. For each of these RB models, we computed the corresponding parameters required by a LV-T models (see below) across a range of trait values, to estimate the shape of the emergent competition functions implied by the model. We then assessed the shape of these functions, and whether they varied with the absolute value of traits, and the density of competitors.

\subsection{A LV-T model}

In the standard Lotka-Volterra model, the rate of increase in the abundance of population $i$ is expressed as a function of the abundance of population $i$, $N_i$; the intrinsic maximum possible per-capita growth rate of population $i$, $r_i$; and the degree to which that maximum is reduced by competition with individuals of the same and other population. A commonly used form \citep[e.g.][]{Lotka-1932, Andrewartha-1953, Dieckmann-1999} is 
\begin{equation} \label{eq:LV} 
	\frac{\ud N_i}{\ud t} = N_i\, r_i \left(1 - \sum_j \frac{\alpha_{ij} N_j}{K_i}\right), 
\end{equation}
where $K_i$ is the equilibrium value for $N_i$ when population-$i$ is grown in a monoculture (i.e., the carrying capacity), and $\alpha_{ij}$ is the per-capita competitive effect of population-$j$ on population-$i$, and the sum is over all population in the community, including population $i$. Eq. \ref{eq:LV} implies competitive effects are additive over all individuals in a community and per capita growth declines linearly with the abundance of each population. By convention, competition coefficients are expressed as the effect of population-$j$ on population-$i$, relative to the effect of population-$i$ on itself, so $\alpha_{ii} \equiv 1$. While subtle variations of equation (\ref{eq:LV}) are often used \citep[e.g.][]{Chesson-2000, Leimar-2013}, they represent competitive impact in an equivalent fashion and so produce similar results.

\subsection{Method for estimating emergent competition functions}

We are interested in situations where the different parameters in equation (\ref{eq:LV}) are functions of traits; that is in expressing the subscripts in the above equations as continuous functions of population traits $x$. In particular, when the coefficient $\alpha_{ij}$ becomes a function $\alpha(x_i, x_j)$. We restricted our analysis to the simplest situation where a single type with trait $x_I$ invades a community comprising a single resident type with trait $x_R$ at equilibrium (i.e., $N_j = K_j$). The fitness $w_I(x_I, x_R)$ of the invading type is its per capita rate of increase when rare ($N_I = 0$), or: 
\begin{equation}\label{eq:LVi}
  w_I(x_I, x_R) = \frac{\ud N_I}{\ud t} \frac{1}{N_I} =
    r(x_I)\left(1 - \alpha(x_R, x_I) \frac{K(x_R)}{K(x_I)}\right).
\end{equation}

Several ways of computing competition coefficients have been proposed \citep[e.g.,][]{Abrams-1987,Abrams-2008}, though most are focused on testing the assumption of linearity and constancy of competition parameters and not on the shape of the competition functions in relation to traits. Our estimate was calculated simply by solving for the competition coefficient in the LV-T model. \citet{Ricklefs-1973} suggested a similar approach for estimating the size of competition coefficients from field data. 

To estimate the shapes of competition functions embedded within the consumer-resource and size-based successional models, we used each model to calculate all of the terms in eq. \ref{eq:LVi} except $\alpha(x_R, x_I)$:
\begin{enumerate}
\item $r(x_I)$: maximum possible fitness of invader, i.e. fitness in the empty environment,
\item $K(x_I)$: equilibrium population density of invader when growing in monoculture,
\item $K(x_R)$: equilibrium population density of resident when growing in monoculture, and
\item $w_I(x_I, x_R)$: fitness of rare invader with traits $x_I$ in competition with a established resident with traits $x_R$.
\end{enumerate}

For each model, we computed these core quantities across a range of invader trait values. We then solved for $\alpha(x_R, x_I)$ by rearranging eq. \ref{eq:LVi} to estimate the emergent competition functions as
\begin{equation} \label{eq:alpha}
  \alpha(x_R, x_I) = \frac{K(x_I)}{N_R} \left(1 - \frac{w_I(x_I, x_R)}{r(x_I)}\right),
\end{equation}
where $N_R = K(x_R)$ (abundance at equilibrium). 

For each model, we considered two resident communities; one where invasion by other strategies was possible -- i.e. the resident was located away from the evolutionary attractor, and one where invasion was not possible -- the resident was located at the evolutionary attractor. The evolutionary attractor is the trait value towards which selection (in the model) drives the system.

\subsection{Methodological test: A model with known competition function}

To verify that our approach for estimating competition functions accurately recovers the competition functions used within a model, we tested it on a model with known solution. Using the model of \citet{Dieckmann-1999}, we estimated the shape of the competition function embedded within the equations, as if we didn't know the answer, and compared this to the true generating value.

The model from \citet{Dieckmann-1999} considers a system following the dynamics described in equation eq. \ref{eq:LVi}, where maximum growth rate is constant across populations, carrying capacity is a Gaussian function of the invader trait, and the competition function is a Gaussian based on the difference between traits of the invader and resident:
\begin{subequations}
\begin{align}
\label{eq:DD}
r(x_I) &= r_0, \\
K(x_I) &= K_0 \exp\left(-\frac{\left(x_I-x_0\right)^2}{2\sigma^2_K}\right), \textrm{and}\\
\alpha(x_R, x_I) &= \exp\left(-\frac{\left(x_I-x_R\right)^2}{2\sigma^2_C}\right).
\end{align}
\end{subequations}
Here $x_0$ is the evolutionary attractor trait value, while $\sigma^2_K$ and $\sigma^2_C$ are the variances of the Gaussian functions for carrying capacity and competition function, respectively.   Following \citet{Dieckmann-1999}, we let $r_0=1.0$, $x_0=0.0$, $K_0=500$, $\sigma^2_K=1$, and $\sigma^2_C=0.4$ --  a scenario which enables invasion of new strategies at the evolutionary attractor \citep{Dieckmann-1999}.

Our proposed method for recovering the shape of a competition function within a model was able to accurately recover the Gaussian-shaped competition functions used by the model of \citet{Dieckmann-1999}. Fig. \ref{fig:components}a-f show how elements of the model vary for two different resident communities: one away from (\ref{fig:components}c-d) and one at (\ref{fig:components}e-f) the evolutionary attractor. In this model, selection drives traits towards a point where the fitness landscape becomes a minimum, and therefore evolutionary branching could potentially occur \citet{Dieckmann-1999}. The resulting competition functions estimated by our method are shown in Fig. \ref{fig:components}d and Fig. \ref{fig:components}f, respectively. Both estimated functions recovered the true Gaussian function applied within the original model. Note also that the competition functions do not vary in shape, only in position (compare panels d and f) along the trait axis for the different resident scenarios. This illustrates that the functions depend only on the difference in trait values, not the absolute value of trait values.

% I'm wondering if we should keep in the appendix the results for the
% other derivation of the competition based on the partial derivative of
% the fitness as in Abrams. This is quite classical. "In the appendix
% we also compare our estimate of the competition coefficient to the
% approach of \citet{Abrams-1987}."

\subsection{RB model 1: Tilman's consumer-resource model}

The Consumer-resource model is one of the best studied and cited models of resource competition \citep{Tilman-1977, Tilman-1982, Huisman-2001}, originating from a study on exploitative competition for any pair of generic resources \citep{Leon-1975}. We implemented a version where the growth rates follow a Monod equation \citep{Huisman-2001}, with parameter trade-offs assumed by \citet{Fox-2008}.

Individuals in the Consumer-resource model compete in an unstructured environment for two essential resources. Per capita growth rates for each type depend on the availability of the resource that is currently most limiting. Let $R_1, R_2$ be the abundances of the two resources. The change in population size of type $i$ is then
\begin{equation}
  \label{eq:rstar-n}
  \frac{\ud N_i}{\ud t} = N_i \, \left(\min\left(\frac{r_i R_1}{U_{1i} + R_1}, \frac{r_i R_2}{U_{2i} + R_2}\right) - m\right),
\end{equation}
where $r_i$ is the maximum growth rate of type $i$; $m$ is the mortality rate, $U_{ki}$ is the half-saturation of resource $k$ for type $i$ (thus higher $U_{ki}$ thus means more resources are needed for a given growth rate). The dynamics of the resources themselves are given by
\begin{equation}
  \label{eq:rstar-r}
  \frac{\ud R_k}{\ud t} =
  D (S_k - R_k) - \sum_{i=1}^n {C_{ki} N_i
    \min\left(\frac{r_i R_1}{U_{1i} + R_1}, \frac{r_i R_2}{U_{2i} + R_2}\right)},
\end{equation}
where $D$ is the resource turnover rate, $S_k$ is the supply rate of resource $k$, 
$C_{ki}$ is the content of resource $k$ by type $i$.

Following previous studies \citep{Tilman-1985, Schreiber-2003, Fox-2008}, we let a trait $x_i$ determine the relative amounts of the two resources required for growth of individuals in type $i$: \begin{equation}
\label{eq:R3}
x = U_{1i} = 1 - U_{2i}.
\end{equation}
Populations thus vary from requiring mostly resource 2 ($x << 0.5$), to equal amounts of both resources ($x = 0.5$), to mostly resource 1 ($x >> 0.5$).

We considered two cases of this model, one with symmetric resource contents for the two populations, and another with asymmetric resource contents.

Because $C$ does not vary by population (we assume that all strategies have identical resource contents $C_{.i} = C_{.j}$), coexistence was not possible in this model \citep{Tilman-1982}. Invasion is therefore sufficient for competitive replacement.

Parameters were set as $m = 0.25$, $D=0.25$, and $r_i = 1$. For the symmetric case, we assumed $C_{.i} = C_{.j} = [2,2]$ for both populations and a supply rate of $S = [0.25, 0.25]$.  For the asymmetric case we assumed $C_{.i} = C_{.j} = [0.3,0.7]$ and $S = [0.5, 0.5]$.
% See:
%  * R/rstar_model.R: rstar_parameters() for m, D
%  * R/rstar_figure.R: dat_rstar() for C, K, S (K is in fact U)

\subsection{RB model 2: Size-based successional dynamics}

\plant\ is an individual-based model of plant competition for light in a size-structured metapopulation \citep{Falster-2016, Falster-2017}.

The \plant\ model is used here as an example of a broader group of models dealing with size-based successional turnover. Several forest models have a similar overall ecological structure, with the forest comprised of a metapopulation of patches \citep{Huston-1987,Kohyama-1993,Moorcroft-2001, Medvigy-2012, Smith-2014}. A distinct feature of \plant, compared to the others, is the ability to numerically solve equilibrium densities and per-capita growth rates for the metapopulation, and thereby estimate all the components required in eq. \ref{eq:alpha} to estimate the shape of the competition function.

Vegetation in the \plant\ model comprises a large number of patches subject to a disturbance regime. Disturbances clear established vegetation within a patch, which are then recolonised via seed dispersal from other patches. Individual plants progress through their life-cycle, from seeds until reproductive adults. Growth, survival and fecundity rates are determined by the combined effect of an individual's traits, their current size, and the degree of shading from other plants within the same patch. Shading at a given height is computed from the cumulative leaf area above that height. Short-term competitive effects are therefore size-asymmetric. The sole effect of shading (and the only source of competition) is to alter an individual's photosynthetic income. Following \citet{Falster-2017}, fitness of individuals with a given type or trait-combination is calculated by integrating seed output across the entire metapopulation. 

Using \plant, we estimated trait-based competitive functions for two traits whose evolutionary dynamics have recently been investigated \citep{Falster-2017}: leaf mass per unit leaf area (\lma) and height at maturation (\hmat). In the model, \lma\ moderates a physiological trade-off between the cost of building an extra unit of leaf area and the rate of leaf turnover \citep{Wright-2004}. Variation in \lma\ thereby underpins a trade-off between height growth rate and shade-tolerance of seedlings. Meanwhile, \hmat\ moderates the allocation of surplus energy between growth and seed production, as an individual increases in size \citep{Falster-2017}. Full details are in \citet{Falster-2016, Falster-2017}.

\section{Results}

\subsection{Consumer-resource model}

For the Consumer-resource model we considered a trait influencing the relative amounts of the two resources required for growth of individuals under two cases: a symmetric and asymmetric consumption of the two resources (see methods).

In the symmetric case, we first considered a resident with trait $x = 0.6$, intermediate between being completely indiscriminate about the two resources at $x = 0.5$ and a specialist on the resource. This corresponded to a case where the resident was located away from the evolutionary attractor. Results for the fitness landscape (Fig. \ref{fig:Rstar}c) show that the resident is under directional selection towards lower trait values. The emergent competition function (Fig. \ref{fig:Rstar}d) suggests the per capita effect of the resident is stronger with individuals that have higher trait values (i.e. are more specialised than itself). Invaders that were less specialised (i.e., closer to $x = 0.5$ than the resident) experienced less competition from the resident than it exerted on itself (Fig. \ref{fig:Rstar}d). Second, we considered a case where the resident moved to $x = 0.5$, i.e. completely indiscriminate about the two resources and at the the evolutionary attractor. In this case, invasion was not possible for any other type (Fig. \ref{fig:Rstar}e). The strength of competition increased monotonically away from the resident (Fig. \ref{fig:Rstar}f). The shape of the competition function relative to the trait of the resident varied drastically with the absolute location of the resident (competition function is offset from the resident trait Fig. \ref{fig:Rstar}d whereas competition function is symmetrical respectively from the resident trait Fig. \ref{fig:Rstar}f). In addition, the shape of the functions produced (Fig. \ref{fig:Rstar}d-f) look nothing like any of the common shapes depicted in Table \ref{tab:shapes}.

Results for the case where resource consumption was asymmetric are shown in Fig. \ref{fig:rstar_components2}. In that case, consumption rates of resource $2$ are higher than resource $1$; this shifts the model in favour of populations that could most efficiently use resource $2$. With a single resident at $x = 0.7$ (away from attractor), invasion was possible for populations that used $2$ more efficiently ($x$ in $(0.7, \approx 0.99)$). The shape of the emergent competition function was considerably more complicated than the symmetric case Fig. \ref{fig:rstar_components2}d-f, but again, looked nothing like any of the common shapes depicted in Table \ref{tab:shapes}.

\subsection{Size-based successional dynamics: \hmat}

In the \plant\ model, strategies that have different height at reproductive maturity \hmat\ differ in how they allocate resources between growth and seed production at different sizes. Plants with lower \hmat\ allocate effort to seed production earlier, increasing the chances they will achieve some reproduction, but because from that point on they allocate less resources to growth, they are liable to be over-topped and out-shaded by strategies that reproduce later \citep{Falster-2017}.

Reflecting this dynamic, the competition functions that emerged from size-based successional dynamics for the trait \hmat\ were asymmetric (Fig. \ref{fig:plant_hmat}d, f), somewhat resembling the asymmetric function used in some previous studies \citep{Law-1997, Kisdi-1999, Geritz-1999, Egas-2004, Calcagno-2006, DAndrea-2013} (Table \ref{tab:shapes}). This shape arose from joint changes in maximum growth rate, carrying capacity, and fitness with trait values (Fig. \ref{fig:plant_hmat}). As expected, all strategies exerted competition more strongly on strategies that are shorter than them, and less on strategies that taller than them. However, the competition function did not asymptote like the logistic function that has preciously been used to model asymmetric competition (Table \ref{tab:shapes}). The shape of the function also varied with the position of the resident type (compare panels d and f in Fig. \ref{fig:plant_hmat}). As the resident strategy increased in size to reach the evolutionary attractor, the apparent per capita competition was higher (Fig. \ref{fig:plant_hmat}d,f), yet the fitness of smaller strategies improved (Fig. \ref{fig:plant_hmat}c, e).

\subsection{Size-based successional dynamics: \lma}

Strategies with different \lma\ values reflect different compromises struck along the leaf economic spectrum \citep{Reich-1997,Wright-2004}. High \lma\ leaves are costly to deploy but have longer lifespan, so need to be replaced less often. Previous analyses have shown that in a single population system, selection initially favours lower \lma\ values, as the fast growth achieved gives prior access to light \citep{Falster-2017}. On this basis, we might expect the competition function for this trait to also have an asymmetric shape.

The shape of the competition function from size-based successional dynamics for the trait \lma\ was complex (Fig. \ref{fig:plant_lma}d, ) and does not conform to any of the simple shapes in common use (Table \ref{tab:shapes}). This shape arose from joint changes in maximum growth rate, carrying capacity, and fitness with trait values (Fig. \ref{fig:plant_lma}). In contrast to the complex shape of fitness and competition, maximum growth rate and carrying capacity had simple forms, with carrying capacity being approximately Gaussian (Fig. \ref{fig:plant_lma}\,a and b). However, small undulations in the fitness landscapes (Fig. \ref{fig:plant_lma}c, e) were amplified when expressed as a competition function (Fig. \ref{fig:plant_lma}d, f). 

We first looked at the situation where a resident was away from the evolutionary attractor, under directional selection towards lower \lma\ (Fig. \ref{fig:plant_lma}c). In the region of trait space close to the resident type, the emergent competition function was strongly asymmetric (Fig. \ref{fig:plant_lma}d). The resident exerted a large amount of competition on strategies with \lma\ values higher than itself (``slow''strategy strategies) and less on strategies with \lma\ values lower (``fast'' strategy strategies; Fig. \ref{fig:plant_lma}c). Invasion was possible in the region with \lma\ values smaller than the invader until growth and carrying capacity reach a biological limit to invasion. Above the resident \lma\ value, the competition function was sawtooth shaped, before eventually declining steeply.

Moving the resident towards the evolutionary attractor (Fig. \ref{fig:plant_lma}e), invasion became possible through a broad range of trait values, including just below and above the resident value. The emergent competition function (Fig. \ref{fig:plant_lma}f) differed in shape to when the resident was away from the attractor, indicating the shape of the function depends on the location of the resident, as well on difference in trait values.

\section{Discussion}

Abrams-2008: Critical of resource axis.

DAndrea-2016a: Particularly needed are exploring more complex niche mechanisms than the distance-dependent interactions in the MacArthur–Levins model, elucidating the influence of environmental fluctuations on pattern, incorporating intraspecific variation and explicit spatial structure in models, and extending our purview to out-of-equilibrium phenomena such as transients and factors that interact with such dynamics, such as immigration and evolution. 

MacCarthur-1970: Lotka (1932)regarded the expressions in square brackets in these equations as the first terms in a Taylor series and, hence, probably realistic near equilibrium. Although the dynamics of competition usually involve nonequilibrium conditions and, hence, doubtless require more elaborate equations; Eqs. 1 seem very useful for equilibria.


We inferred the shape of the trait-based competition functions that emerge from two different resource-based models of competition, focussing on the situation where a rare new type was invading a monomorphic community. Our hope was that by relating the functions that emerge from the resource-based models to the collection of trait-based functions used in LVMs, we could bridge between two major classes of model used in community ecology. Yet, the competition functions that emerged from the resource-based models bore little resemblance to the shapes used in the LV-T models (especially the Gaussian). Moreover, the shape of these emergent functions varied qualitatively and quantitatively with the identity of the resident, indicating that the per-capita competitive effect is a function of absolute trait values rather than of the difference in trait values, as is commonly assumed. Trivially, these results reinforce previous thoughts that the Lotka-Volterra model provides a poor foundation for modelling some biological phenomena \citep[e.g.][]{Andrewartha-1953,  Neill-1974, Abrams-1975, Wangersky-1978, Abrams-1980, Tilman-1987, Abrams-2008}. Yet, the departure of the emergent shapes from the shapes assumed by in theoretical investigations is so drastic, it seems difficult to reconcile the two approaches. Combined with the difficulty of experimentally measuring trait-based models, we are wondering, like those 50 years before us, if the  \emph{``nearly complete dependence of theoretical community ecology on a limited number of simple models has resulted in the development of subsequent generations of deceptively simple constructs that may often confuse our understanding of the underlying biology rather than improve it.''}  \citep{Neill-1974}. At the same time, such departures can prompt important shifts in direction. For example, have we been focussing our theoretical investigations in an unnecessarily restricted region of the possible model space, meaning there is plenty of the universe yet to be explored?

\subsection{We don't know what real competition functions look like}

One of the reasons we used models to study the shape of competition functions was due to the difficulty of estimating these in the field. Originally, Lotka-Volterra models were formulated using pairwise competition coefficients, calculated between pairs of species. A substantial literature exists around the measurement and interpretation of such coefficients \citep[e.g.][]{Ricklefs-1973, Abrams-1980, Law-1997a,Freckleton-2001, Kraft-2015}. One approach involves measuring the different elements of eq. \ref{eq:LVi} then using these to estimate the competitive interaction (Fig. \ref{fig:components}) \citep{Ricklefs-1973}. This is the method we applied here, only using models instead of real organisms. But estimates of competition coefficients are typically only possible for some short-lived organisms such as annual plants \citep{Kraft-2015, Mayfield-2017, Law-1997,Freckleton-2001}. Moreover, field and experimental data are only ever going to give point estimates of the pairwise competitive effect between two species ($\alpha_{ij}$), not a continuous function. 

Elucidating the shape of a continuous, trait-based function is a bigger and probably unachievable challenge. Ideally, this would require a large number of hypothetical strategies, varying only in the focal trait, and grown in controlled conditions, with fitness measured across their life cycle. Such an experiment is already a difficult task for annuals \citep{Kraft-2015}, but is probably experimentally impossible for long-lived trees.

\subsection{Competition functions in resource-based models look nothing like a  Gaussian}

With limited hope of ever measuring the shape of competition functions from empirical data, resource-based models offer a tool for honing our understanding. Models allow us to integrate empirical data and run experiments in ways that are simply not possible in real systems. Ideally, models integrate existing empirical and conceptual understanding, and then point the way forward.

In this context, it is striking that in only one of the four cases studied here did our derived competition functions even vaguely resemble the dominant shapes used in most theoretical investigations. The most common forms used include the Gaussian, asymmetric (offset) Gaussian, and asymmetric shapes (Table \ref{tab:shapes}). The derived function from the \hmat\ within the size-based successional model mildly resembled the asymmetric functions used in models investigating asymmetric competition \citep{Law-1997, Geritz-1999, Kisdi-1999, Calcagno-2006}. Yet even then, the resemblance was superficial only; and the shape of the emergent function varied with the identity of the competitor. The competition function for our \lma\ model has hints of an asymmetric Gaussian, but the ridges along the top are distinctly non-Gaussian and arise from real biological features of the system. \citet{Falster-2011} showed how the amount of shading undulates through successional time in the meta-community; here this translates into undulations in the fitness of an invader with respect to traits. And finally, the competition functions in different versions of the Consumer-resource model did not resemble either a Gaussian or a asymmetric function.

Our results therefore imply the convenient assumption that competition functions can be defined by a simple function based solely on differences in trait values -- without reference to population size, or absolute value of traits, or resource levels -- may not be appropriate when trying to represent resource-based competition in plant communities. These concerns add to those expressed previously. \citet{Abrams-1980} argued that in the real world there might be widespread density dependence in the competition function - i.e. the $\alpha_{ij}$s in LV-T models varying with density. Many have also questioned more generally whether Lotka-Volterra models are an adequate foundation for modelling biological phenomena  \citep[e.g.][]{Andrewartha-1953, Neill-1974, Abrams-1975, Wangersky-1978,Abrams-1980, Tilman-1987, Abrams-2008}.

\subsection{Where did competition functions come from?}

Given the difficulty of  measuring trait-based competition coefficients, and their lack of alignment with resource-based models, it is worth revisiting their origins, to see what underpinned their emergence into the literature.

In 1960s theory and 1970s textbooks, niches were typically thought of as utilization functions along a continuous resource axis \citep{MacArthur-1967,Abrams-1975} (Fig. \ref{fig:competition-functions}). The resource in question would be depletable or pre-emptable, in order for overlap of utilization functions to translate into competition. Pairwise competition coefficients (i.e. the $\alpha_{ij}$ parameters) could be calculated from the degree of overlap between utilization functions \citep{MacArthur-1967, May-1972, Abrams-1975}. If a trait was used as a niche index, it was chosen on grounds of mapping tidily on to a depletable resource, such as beak size for seed-eating finches. Beginning in the 1980s, a desire to model character displacement saw the concept of a utilisation function first approximated via a trait -- the mean of the utilisation function \citep{Roughgarden-1979} -- and second replaced entirely by a function of trait differences \citep{Slatkin-1980,Taper-1985}. This shift enabled models for character displacement \citep[e.g.,][]{Taper-1985, Case-2000, Goldberg-2006} and trait evolution \citep{Brown-1987, Geritz-1998, Geritz-1999, Dieckmann-1999, Abrams-2001} to be developed, as the competition functions allowed pairwise coefficients to be calculated for any hypothetical combination of traits. However, it seems the shift towards using trait-based competition functions was motivated more by the desire for tractable models than strong empirical foundations.

\subsection{Enhancing the scope of RB models}

\emph{``The analysis of the Lotka-Volterra model developed here can only suggest that, if there are limits to similarity in natural systems, these limits will depend sensitively on the form of the competition coefficient, which must be derived from another model.''}\citep{Abrams-1975}

Given the observed mismatch between the two classes of models, where to next for models of competition?

It is certainly possible to expand the idea of a competition function -- from the current formulations, which are density independent and invariant with respect to the absolute value of traits -- to functions that vary with population densities and with the actual values of species traits. This would enable more complexities to be incorporated. But clearly, with these complications it will be harder to intuit the influence of residents on invasibility, and what configuration of species would be stable. To be robust, new functions would need to be rigorously derived from another detailed model. As well as depending on traits and densities, it would be prudent to expect that the total competitive effect would not sum neatly across species, as is assumed by LV-T models. Indeed, \citet{Levine-1976} already warned that interaction between three or more species in a community could not be easily predicted by summing pairwise interactions, because of potential indirect effects between species. Recently, this notion has been realised via the concept of higher order interactions \citep{Levine-2017} and it has been shown that they can emerge in resource based models such as the Consumer-resource model \citep{Letten-2019}. So the competition would be a function of the entire resident community. But at that point, are we stretching the concept of a competition coefficient beyond its useful limit? We could just as well model a multi-species assemblage with explicit depletion of resources.

At the same time, the shape of the competition functions generated by the RB models studied here raise an exciting possibility: we might be able to substantially expand the range of competition functions currently being considered (Table \ref{tab:shapes}) and thereby expand possibilities for coexistence. It has also become increasingly clear, that the shape of competition function is key to understanding community assembly in LV-T models. Already in the 1970s, and in opposition with the species packing metaphor, several papers questioned whether there was in fact a limit to similarity \citep{May-1972, Abrams-1975, Abrams-1983}, with debate continuing. Since 2000, several authors have begun to explore more systematically the consequences of possible function shapes for community assembly, showing that subtle details about the exact shape of the function can substantially alter the possibilities for coexistence \citep{Calcagno-2006, Scheffer-2006, Pigolotti-2007, Barabas-2012,Barabas-2013,DAndrea-2013,Leimar-2013}. Functions like the \lma\ function (Fig. \ref{fig:plant_lma}) look unusual compared with functions typically used, yet they arise naturally from size-structured dynamics. It is likely that functions of this shape permit coexistence through dynamics quite different from those well studied \citep[e.g.][]{Leimar-2013}, rendering coexistence easier or harder than we might otherwise suppose.

Similarly, it seems productive to further investigate the dynamics of competitive interactions as it relates to traits, but with increased emphasis on the resource that is being contested and the traits that control how that resource is accessed. To that end, we suggest two promising avenues. First, there are currently few models that relate traits to fitness via competition for a common resource, i.e. without including a phenomenological competition function \citep{DAndrea-2016a}. There are many ecosystem models and simulators that include competition for explicit resources, but these are often designed to track bio-geochemical cycles, more than to study competition among strategies \citep{Fisher-2018}. Indeed, the diversity of strategies is often fixed. Retooling such models so that they can also analyse the dynamics of competing species would expand the range of possibilities, in what seems like an underdeveloped area of theory.

Second, given the difficulty in linking RB models to competition functions, we suggest shifting focus away from the competition functions or coefficients per se, and focussing instead onto the ways competition impacts on fitness landscapes and resources. A notable feature of our results, particularly those from the size-based successional model, was that the impacts of competition on fitness landscapes are more orderly and intuitive than the shapes of the derived competition functions (Figs. \ref{fig:Rstar} - \ref{fig:plant_lma}). Fitness landscapes capture the combined effects of all features of a species demography, including competition. Comparing landscapes with and without competition allows one to see precisely how the growth rate for all strategies is reduced by the presence of an existing type, e.g. compare panel a (no competition) vs panels c and e (with competition) in Figs. \ref{fig:Rstar} - \ref{fig:plant_lma}). 

Simultaneously, we should be looking to derive macroscopic approximations of the more-detailed RB models. Simple models can be powerful tools, provided they capture the main emergent features of a system \citep{Levin-2006}. The LV-T model may not approximate the RB models used here very well, but other models may. The LV-T model model was formulated in isolation from the problems to which it is now being applied. We should therefore seek simple models that can be derived from more complex and realistic models and empirical findings \citep[e.g.][]{Champagnat-2006}.

\subsection{Conclusions}

Despite being difficult to quantify in the field and to represent in models, competition is undoubtedly a powerful force in structuring communities. Our results reinforce previous arguments that if competition is density dependent or non-additive across species, or if the shape of competition varies with species traits and not just distance, then the LV-T model will not adequately capture the dynamics of real systems \citep{Andrewartha-1953, Neill-1974, Abrams-1975, Wangersky-1978,Abrams-1980, Tilman-1987}. It is difficult see what a new set of equations might look like. However, as a first step we might more vigorously focus on models where resources are handled explicitly. In contrast with the close attention paid to LV-T models with competition coefficients, relatively few models exist where competition emerges from the interactions of species with depletable resources. This is a potentially untapped source of insight into the dynamics of competition.

\clearpage

\section{Tables}

\begin{table}[h]
 \caption{Example shapes of competition functions used to represent competition in trait or resource space.  `Kinked' functions refers to those that are ``non-differentiable at the point of self-competition'' \citep{Barabas-2012}.  Equations are presented only to give a general idea of shapes in terms of species trait differences ($\Delta x$); various scaling parameters are common, and specific to different implementations. }

\centering
{\footnotesize
\renewcommand{\arraystretch}{1.5}  % more space between rows of table
\def\minifigheight{5ex}
\begin{tabularx}{\textwidth}{lclp{5cm}}
  \hline
  Name & Shape & Representative equation & Example references \\
  \hline
    \textbf{Continuous}\\[1ex]
    %
    Constant &\adjustbox{valign=t}{\includegraphics[height=\minifigheight]{ms/figures/shape/constant.pdf}}& $c$ & \citet{Hubbell-2001} \\
    %
    Gaussian &\adjustbox{valign=t}{\includegraphics[height=\minifigheight]{ms/figures/shape/gaussian}}& $\exp\left(-\frac{(\Delta x)^2}{\sigma^2}\right)$ & \citet{Slatkin-1980, Taper-1985, Dieckmann-1999}\\
    %
    Platykurtic &\adjustbox{valign=t}{\includegraphics[height=\minifigheight]{ms/figures/shape/platykurtic}}& $\exp\left(-\frac{(\Delta x)^4}{\sigma^2}\right)$&  \citet{Leimar-2013} \\
    %
    Exponential &\adjustbox{valign=t}{\includegraphics[height=\minifigheight]{ms/figures/shape/exponential}}& $\exp(d x)$ &\citet{Pigolotti-2007}\\
    % Add scaling term on the dx that's important for connecting with asymmetric step where d = infty
    Asymmetric &\adjustbox{valign=t}{\includegraphics[height=\minifigheight]{ms/figures/shape/logistic}} & $\frac{1}{1 + \exp(d \,\Delta x)}$ & \citet{Law-1997, Kisdi-1999, Geritz-1999, Egas-2004, Calcagno-2006, DAndrea-2013}\\
    %
    Offset Gaussian &\adjustbox{valign=t}{\includegraphics[height=\minifigheight]{ms/figures/shape/gaussian_offset}}& $\exp\left(-\frac{(\Delta x - b)^2}{\sigma^2}\right)$ & \citet{Slatkin-1980, Rummel-1985,Brown-1987-66}\\
    %
    Gaussian with hat &\adjustbox{valign=t}{\includegraphics[height=\minifigheight]{ms/figures/shape/gaussian_with_hat}}& 
    % TODO This eqn looks ugly, wonder if we need it?
    {\tiny $c \exp\left(-\frac{(\Delta x)^2}{\sigma_1^2}\right)+(1-c) \exp\left(-\frac{(\Delta x)^2}{\sigma_2^2}\right)$}
    &  \citet{Barabas-2013, Leimar-2013} \\
    %
      \textbf{Kinked}\\[1ex]
    Laplacian &\adjustbox{valign=t}{\includegraphics[height=\minifigheight]{ms/figures/shape/laplacian}} & $\exp(-2|x|)$ & \citet{Roughgarden-1972, Leimar-2013} \\
    %
    Asymmetric step
       &\adjustbox{valign=t}{\includegraphics[height=\minifigheight]{ms/figures/shape/step_asymmetric}} & $ \frac{1}{1 + \exp(\infty \, \Delta x)},$  & \citet{Kinzig-1999, Egas-2004, Calcagno-2006, DAndrea-2013} \\
    Gaussian with spike &\adjustbox{valign=t}{\includegraphics[height=\minifigheight]{ms/figures/shape/gaussian_with_spike}} & 
        {\tiny $c \exp\left(-\frac{(\Delta x)^2}{\sigma_1^2}\right)+(1-c) \exp\left(-\frac{(\Delta x)^2}{\infty}\right)$}
        & \citet{Scheffer-2006, Barabas-2013} \\
    \hline
  \end{tabularx}
}
\label{tab:shapes}
\end{table}

\clearpage

\section{Figures}

\begin{figure}[ht]
  \centering
  \includegraphics{ms/figures/kernel}
  \caption{{\bf Classic textbook view of niche differentiation, based on either Gaussian resource utilisation curve or competition functions.} Along the x-axis is a resource to be partitioned, such as food or prey size, or alternatively a trait axis.  Lines represent hypothetical resource utilisation curves for five different species, indicating the propensity of that species to use resources of a given particle size. Competition between two species will be proportional to the overlap in their resource utilisation curves. \citet{MacArthur-1967} proposed that competition would limit how closely species could sit relative to one another, via the width of utilisation curves. Soon after its publication, this idea of `limiting similarity` appeared in ecology textbooks. Figures similar to this appeared in the earliest editions of leading textbooks, continuing up to recent editions: \citet[Fig. 7.9]{Begon-1986}; \citet[Fig. 8.29]{Begon-2006}; \citet[Fig. 12.20]{Krebs-1978}; \citet[Fig. 19.15]{ Krebs-2013}; \citet[Fig. 36.13]{Ricklefs-1973}; \citet[Fig. 29.19]{Ricklefs-1999}.} 
  \label{fig:competition-functions}
\end{figure}

\clearpage

\begin{figure}[ht]
 \centering
 \includegraphics[width=1.0\textwidth]{ms/figures/components}
 \caption{{\bf Demonstration of our method for estimating the shape of a competition function embedded in a model with known solution.} For each model analysed, we use the model to calculate all of the terms in the LV-T model (eq. \ref{eq:LVi}), including: (a) the fitness of a rare invader growing without competition ($r(x_I)$), (b) the equilibrium population density of invader and resident when growing in monoculture ($K(x_I)$, $K(x_R)$), (c, e) the fitness of a rare invader growing in competition with an established resident ($w_I(x_I, x_R)$), represented by a point. From these elements, we can estimate the shape of the competition function (d, f). Solid black bars indicating regions where the invader has positive fitness, i.e. could successfully establish. Note that panels (a)-(b) do not depend on the location of the resident community whereas panels (c)-(f) do. Panels (c, d) show a situation where the resident is away from it's local evolutionary attractor, whereas in (e, f) the resident is at its evolutionary attractor. Resident trait values are: (c,d) x= -1.0, (e,f) x = 0.0. All other parameters are given in the Methods and also in the code.}
\label{fig:components}
\end{figure}

\clearpage

\begin{figure}[ht]
  \centering
	\includegraphics[width=1.0\textwidth]{ms/figures/rstar_components1}
  \caption{{\bf Shape of competition function embedded within the Consumer-resource model for a trait determining the stoichiometry of uptake for two essential resources, with symmetric resource consumptions.} Panel descriptions as in Fig. \ref{fig:components}. Parameters for the symmetric case, $C = \{2, 2\}$.   Resident trait values are: (c,d) 0.6, (e,f) 0.5. All other parameters are given in the Methods and also in the code.}
  \label{fig:Rstar}
\end{figure}

\clearpage

\begin{figure}[ht]
 \centering
 \includegraphics[width=1.0\textwidth]{ms/figures/rstar_components2}
 \caption{{\bf Shape of competition function embedded within the Consumer-resource model for a trait determining the stoichiometry of uptake for two essential resources, with asymmetric resource consumptions.} Panel descriptions as in Fig. \ref{fig:components}. Parameters for the asymmetric case $C = \{0.3, 0.7\}$. Resident trait values are: (c,d) 0.7, (e,f) 0.9. All other parameters are given in the Methods and also in the code.} 
  \label{fig:rstar_components2}
\end{figure}

\clearpage

\begin{figure}[ht]
 \centering
 \includegraphics[width=1.0\textwidth]{ms/figures/plant_hmat_components}
 \caption{{\bf Shape of competition function emerging from size-based successional dynamics for the trait \hmat.} 
	Panel descriptions as in Fig. \ref{fig:components}. Resident trait values are: (c,d) \hmat = 5, \lma = 0.3, (e,f) \hmat = 15.5,\lma = 0.3. All other parameters are given in the code.}
 \label{fig:plant_hmat}
\end{figure}

\clearpage

\begin{figure}[ht]
  \centering
  \includegraphics[width=1.0\textwidth]{ms/figures/plant_lma_components}
  \caption{{\bf Shape of competition function emerging from size-based successional dynamics for the trait \lma.} 
  Panel descriptions as in Fig. \ref{fig:components}. Resident trait values are: (c,d) \lma\ = 0.17, \hmat = 15 (e,f) \lma\ = 0.07, \hmat = 15. All other parameters are given in the code.}
  \label{fig:plant_lma}
\end{figure}

\clearpage

\bibliographystyle{ms/amnat}
\bibliography{ms/references}

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:

